DUNFIELD 8051 ASSEMBLER: sqwave2                                      PAGE: 1

0000                         1  	ORG  $0000			
0000  02 10 00               2  	LJMP INIT		Jump to main program
000B                         3          ORG $000b		ISR address for Timer 0
000B  D2 91                  4  	SETB P1.1		Set P1.0 when ISR starts
000D  02 20 00               5  	LJMP ISR		Jump to service routine code
0010                         6  
1000                         7          ORG $1000		Main program starts
1000  75 A8 82               8  INIT:   MOV IE,#82h		Enable global interrupts and timer 0 interrupt
1003  75 8C DC               9  	MOV TH0,#0DCh		Load Timer 0 with 16 bit value to delay for 10ms
1006  75 8A 1A              10  	MOV TL0,#0AAh		
1009  75 89 01              11  	MOV TMOD,#01h		Select Timer 0 Mode 0
100C  D2 90                 12  	SETB P1.0		Initialise P1.0
100E  78 16                 13  	MOV R0,#16h		Initialise counter for 217ms delay	
1010  D2 8C                 14  	SETB TCON.4		Start timer0
1012  80 FE                 15  here    SJMP here		Enter infinite loop
1014                        16  	
2000                        17          ORG $2000		Service routine for Timer 0
2000  75 8C DC              18  ISR:	MOV TH0,#0DCh		Reload Timer 0 with 16 bit value to delay for 10ms
2003  75 8A 1A              19  	MOV TL0,#0AAh
2006  D8 04                 20  	DJNZ R0,down		Check if 217ms have elapsed
2008  B2 90                 21  	CPL P1.0		If 217ms elapsed, complement port bit P1.0
200A  78 16                 22  	MOV R0,#16h		Reset counter for 217ms delay
200C  D2 8C                 23  down:   SETB TCON.4		Restart Timer0
200E  C2 91                 24  	CLR P1.1		Clear port bit P1.1 once service routine is serviced
2010  32                    25  	RETI			Return to main program
2011                        26  END
